import * as React from 'react';
import Head from 'next/head';
import Header from '../components/Header/Header';
import MainPage from '../components/MainPage/MainPage';
import Layout from '../components/Layout/Layout';
import { IPageProps } from './_app';
import { IVPSPlan } from '../helper/types/products/VPS/plan';
import { IDedicatedPlan } from '../helper/types/products/Dedicated/plan';
import { IHostPlan } from '../helper/types/products/Host/plan';
import 'slick-carousel/slick/slick.css';
import 'slick-carousel/slick/slick-theme.css';

interface IProps extends IPageProps {
  hosts: { linux: IHostPlan[]; windows: IHostPlan[] };
  servers: { vps: IVPSPlan[]; dedicated: IDedicatedPlan[] };
}

class Index extends React.Component<IProps> {
  render() {
    return (
      <div dir="rtl">
        <Head>
          <title>هاستینگ جی سرور | فروش هاست لینوکس با کیفیت</title>
          <meta name="description" content="Generated by create next app" />
          <link rel="icon" href="/favicon.ico" />
        </Head>

        <Layout header={this.props.header} footer={this.props.footer}>
          <Header />
          <MainPage
            tablesData={{
              hosts: this.props.hosts,
              servers: this.props.servers,
            }}
          />
        </Layout>
      </div>
    );
  }
}

export async function getServerSideProps(context) {
  const locale = context.locale;

  if (locale !== 'fa') {
    return {
      notFound: true,
    };
  }

  const respone = await fetch(
    `${process.env.SCHEMA}://${process.env.DOMAIN}/${locale}?ajax=1`
  );
  const data = await respone.json();

  return {
    props: {
      ...data,
    },
  };
}

export default Index;
