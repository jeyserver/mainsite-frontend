import * as React from 'react';
import Head from 'next/head';
import Footer from '../../../components/Footer/Footer';
import Navbar from '../../../components/Navbar/Navbar';
import CountryPlan from '../../../components/Dedicated/CountryPlan/CountryPlan';

export interface IndexProps {
  countryPlan: {
    status: boolean;
    id: number;
    title: string;
    price: number;
    ip: {
      price: number;
      max: number;
    };
    panels: {
      link: string;
      name_fa: string;
      name_en: string;
    }[];
    datacenter: {
      title: string;
      link: string;
      country: { code: string; name: string };
    };
    hard: { type: string; space: number; price: number; onsell?: boolean }[][];
    cpu: {
      type: string;
      title: string;
      cores: number;
      threads: number;
      speed: number;
      num: number;
    };
    bandwidth: number;
    traffic: number;
    port: number;
    ram: number;
    raid: null;
    setup: number;
    currency: { id: number; title: string; update_at: number };
    sold_out: number;
  };
}

export interface IndexState {}

class Index extends React.Component<IndexProps, IndexState> {
  constructor(props: IndexProps) {
    super(props);
    this.state = {};
  }

  render() {
    return (
      <div dir="rtl">
        <Head>
          <title>سرور اختصاصی {this.props.countryPlan.title}</title>
          <meta name="description" content="Generated by create next app" />
          <link rel="icon" href="/favicon.ico" />
        </Head>

        <Navbar />

        <CountryPlan countryPlan={this.props.countryPlan} />

        <Footer />
      </div>
    );
  }
}

export async function getServerSideProps(context) {
  // const countryPlanRes = await fetch(
  //   `${process.env.SCHEMA}://${process.env.DOMAIN}/fa/server/dedicated/88?ajax=1`
  // );
  // const countryPlan = await countryPlanRes.json();

  const countryPlanRes = await fetch(
    'https://jsonblob.com/api/jsonBlob/44b4192b-d7e8-11eb-9f33-29283d818ddf'
  );
  const countryPlan = await countryPlanRes.json();

  return {
    props: {
      countryPlan: countryPlan,
    },
  };
}

export default Index;
